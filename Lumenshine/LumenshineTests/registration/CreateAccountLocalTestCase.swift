//
//  CreateAccountLocalTestCase.swift
//  Lumenshine Tests
//
//  Created by Istvan Elekes on 4/23/18.
//  Copyright Â© 2018 Soneso. All rights reserved.
//

import XCTest
import Lumenshine
import stellarsdk

class CreateAccountLocalTestCase: XCTestCase {
    
    override func setUp() {
        super.setUp()
        
    }
    
    override func tearDown() {
        super.tearDown()
    }
    
    func test1AccountGeneration() {
        do {
            let passwordSalt = "G8YU7hJr00OQbiLimVP9HdvPvbWTxsOOGtkBzfFmBJg="
            let derivedPassword = Data(base64Encoded: "OzeW4ddXdGewf8HnqRsJpr20bDSmT/7VqW7pLUm8Sn4=")?.bytes
            
            let wordListMasterKey = Data(base64Encoded: "KJQNkiHnKbCi9PnTG9NrOTx6bVU6++7ODLXbVFi5L3I=")?.bytes
            let wordListMasterKeyEncryptionIV = Data(base64Encoded: "5RnFHrh3vQeZOaA4ZKKOdg==")?.bytes
            let encryptedWordListMasterKey = try CryptoUtil.encryptValue(plainValue: wordListMasterKey!, key: derivedPassword!, iv: wordListMasterKeyEncryptionIV!)
            
            XCTAssertNotNil(encryptedWordListMasterKey.toBase64())
            XCTAssertEqual(encryptedWordListMasterKey.toBase64(), "6URs+BSmQpwJ9CQCA9lU2VQcIaAvahaeNFJWURpFRmo=")
            
            let wordList = "warrior,ginger,trigger,velvet,dismiss,bar,hood,dynamic,roast,member,cloth,city,news,party,slush,exclude,error,version,suspect,joy,knife,exact,rather,pitch,space,library,exercise,future,project,latin,juice,base,evidence,focus,goddess,soon,sauce,practice,company,duty,birth,embark,ribbon,until,soap,never,hover,spread,welcome,special,hurt,vehicle,stick,name,friend,stone,fiber,lab,cricket,copy,note,crouch,sleep,fiction,banner,afraid,wedding,lawn,unique,spend,citizen,please,decade,gather,ten,foil,attack,patient,squeeze,duck,output,miracle,easy,laptop,index,click,student,dutch,expire,flee,chest,start,beauty,drum,exit,swallow,deal,expose,bicycle,involve,fly,accident,faint,camera,judge,alert,shield,switch,vote,deliver,universe,canyon,census,assist,ripple,motion,uphold,deputy,suggest,lawsuit,route,course,mystery,cactus,wonder,raise,blue,upgrade,can,word,faith,prepare,fluid,begin,stove,garbage,solar,scan,blush,multiply,way,elegant,fuel,pipe,pretty,year,hen,wreck,pigeon,peanut,onion,disagree,pony,digital,hello,clean,bonus,survey,brisk,brother,midnight,promote,advice,shoe,baby,rude,great,reduce,brand,solution,private,tide,arrow,limit,cinnamon,leg,demise,crawl,disorder,reflect,small,very,toward,pen,flash,entire,section,season,control,quote,enough,analyst,couple,odor,false,zebra,gym,budget,same,chuckle,lesson,soccer,steel,prevent,guard,drastic,memory,regular,joke,allow,door,during,gossip,melody,wrap,jealous,favorite,museum,type,element,credit,cruel,donate,comic,scare,success,swarm,nation,toast,poem,layer,lion,dove,smile,ahead,random,defense,bright,excuse,there,jar,response,destroy,glide,hurdle,custom,teach,letter,lunch,struggle,divert,script,oil,join,rose,broccoli,drip,flock,poet,asset,mad,animal,brown,bag,orbit,wish,essence,unfold,inherit,age,six,surface,music,right,material,audit,burst,pumpkin,slide,ball,truly,rare,purse,cattle,derive,harvest,sword,figure,power,decide,regret,myself,tuition,dog,physical,run,patrol,major,one,fix,humble,sand,puppy,carry,enlist,clutch,clock,region,volcano,illegal,price,tilt,thing,dizzy,sail,dish,eyebrow,giggle,purpose,unusual,master,sponsor,normal,color,deny,receive,deposit,sick,sunny,chair,mosquito,donor,use,ozone,flip,coast,maximum,common,brush,escape,together,fine,metal,still,manual,evolve,sadness,urge,between,what,tip,income,business,vital,vendor,tent,post,bubble,matrix,captain,walnut,scatter,drill,hotel,clown,fruit,desk,ladder,belt,humor,dry,lecture,aspect,action,mimic,casino,summer,fault,dune,usual,bunker,margin,push,throw,anchor,salon,heavy,soup,hat,eternal,first,coil,cram,neck,hire,marine,cement,include,lens,vast,end,extend,book,track,cream,beyond,plunge,put,depart,rail,swing,goat,green,seed,long,rural,stay,cube,detail,want,cute,palm,puzzle,dream,acoustic,treat,usage,melt,over,casual,link,gun,hint,thunder,umbrella,castle,guide,jelly,slow,fee,own,harbor,erode,fancy,advance,water,chronic,congress,pond,initial,wolf,perfect,similar,combine,echo,hundred,twenty,slot,lobster,mushroom,jump,salt,satoshi,chunk,enrich,radio,crunch,sibling,wheat,victory,village,climb,skill,kid,style,trash,various,oppose,island,approve,narrow,brass,true,pass,aunt,series,before,shadow,oyster,relax,salmon,day,tuna,foot,awesome,pledge,label,also,spike,learn,boss,travel,length,equip,march,west,scrap,clever,best,above,whale,muscle,title,acquire,gasp,tragic,toy,cancel,penalty,few,sound,cry,doctor,federal,mom,fan,pistol,ability,arrange,divorce,dinosaur,devote,noodle,behind,spatial,life,slogan,gown,boring,trend,heart,short,chimney,main,junk,jewel,shuffle,task,recall,picture,mouse,average,when,below,ocean,genuine,zoo,brain,cupboard,possible,fragile,opera,among,pepper,present,grain,speed,diamond,property,outer,high,spare,car,inquiry,leader,unveil,motor,moon,mind,cheese,soul,genius,million,web,floor,inside,equal,ecology,clump,reform,salad,mutual,sunset,orchard,aim,weasel,govern,saddle,grape,pattern,staff,cover,bean,pact,omit,spirit,tiger,luggage,swim,snow,embody,abuse,hungry,crisp,valid,laundry,stem,conduct,charge,mammal,across,shy,twice,void,easily,account,arch,three,mango,wave,elite,evil,proud,offer,fit,mobile,carpet,prison,setup,siege,point,net,local,walk,rib,van,famous,churn,seminar,dignity,alien,owner,option,antenna,path,list,orient,slender,reveal,file,repair,world,flight,author,always,absent,nasty,curve,toilet,impulse,rigid,expect,all,round,early,vibrant,suit,whip,young,host,disease,entry,camp,grocery,into,mean,almost,parrot,canal,head,decline,bulk,pluck,artist,forest,atom,brick,kiwi,actual,mixture,stool,sing,rice,vocal,polar,inmate,lift,absurd,absorb,theory,evoke,proof,fatigue,indoor,sense,impact,hard,popular,quantum,fire,tower,hair,fox,mandate,home,athlete,civil,stable,time,real,current,choice,need,kite,prosper,waste,lamp,circle,supply,make,model,basic,legal,pudding,shock,foam,film,junior,sea,more,skin,clip,twelve,coconut,october,flat,infant,outdoor,knee,trial,loan,train,laugh,resemble,carbon,rhythm,palace,orange,undo,shoulder,town,rival,injury,hero,renew,fold,surge,jaguar,gravity,print,sad,cushion,slight,finish,wage,ivory,festival,dwarf,catch,capable,tattoo,frog,help,eight,warm,valley,tank,solve,now,board,someone,ticket,drink,frost,neutral,essay,catalog,release,artwork,spoon,engage,ridge,repeat,inform,predict,nerve,choose,nut,tooth,service,stock,collect,shallow,trap,blast,rack,guilt,position,seat,cart,army,whisper,cross,abandon,apple,found,they,give,slice,network,clerk,utility,upon,wife,shop,bomb,bridge,two,paddle,any,dolphin,horror,youth,nothing,armed,cliff,oak,used,system,witness,view,immune,shell,planet,eager,talent,amazing,bracket,beef,scrub,lock,logic,chapter,corn,stairs,crucial,become,canoe,enact,street,review,stomach,forum,story,orphan,cake,record,sudden,capital,oval,idle,must,pet,rent,knock,industry,distance,empty,trip,rocket,enforce,typical,mechanic,large,visit,quarter,swift,adult,cigar,increase,question,discover,blossom,submit,pill,grit,leaf,page,hammer,crowd,bike,clay,cannon,mixed,sort,supreme,toddler,state,crew,define,payment,borrow,balance,erupt,chat,elephant,culture,cost,night,return,sock,gospel,reject,enjoy,sniff,spy,icon,middle,hidden,eye,shed,brave,theme,box,message,hole,recipe,crash,galaxy,blouse,ask,wood,edit,fiscal,gallery,plastic,vanish,produce,hurry,noise,pelican,horse,emotion,neglect,second,target,aerobic,silly,field,crush,gap,bottom,unfair,stumble,scout,endless,coyote,neither,pause,curtain,save,photo,gift,enroll,tag,lake,ritual,vault,sweet,auction,breeze,accuse,permit,noble,remind,gauge,near,access,priority,like,clog,zero,dentist,girl,move,wisdom,loyal,invest,grass,vague,example,gloom,people,tree,surprise,giant,spring,panda,topic,thought,creek,alcohol,chaos,wear,steak,fantasy,upper,pull,cheap,lottery,crime,exchange,vacuum,coin,sentence,kangaroo,body,such,kingdom,unlock,pioneer,furnace,obtain,diagram,twin,bind,sorry,top,hockey,acid,portion,merge,keen,under,ancient,better,elevator,mercy,hazard,often,torch,cable,art,thrive,labor,crumble,client,lucky,group,meadow,speak,argue,liberty,trophy,lemon,rate,online,august,alpha,sign,black,area,off,away,wrist,hedgehog,dirt,resist,monster,test,hospital,harsh,unable,yellow,lend,runway,praise,silk,you,wink,card,spice,tennis,marble,farm,fatal,verify,ice,fortune,arena,lumber,erosion,pear,have,innocent,design,input,occur,venue,feature,trumpet,minimum,agent,notable,differ,moment,axis,jungle,scorpion,century,chief,parade,dress,attitude,refuse,gorilla,ship,cruise,connect,cash,slim,gate,rug,pupil,episode,afford,elbow,consider,exile,device,female,fossil,voice,expand,foster,trim,senior,dose,benefit,faculty,south,sheriff,process,medal,report,buyer,segment,solid,obscure,spawn,attend,legend,blanket,display,problem,mask,spoil,close,seven,child,toe,reason,guitar,actor,purchase,will,burden,border,hawk,merit,era,say,cabin,history,huge,silent,month,machine,awkward,tiny,exist,clarify,truth,school,surround,window,text,winter,arm,enable,tube,pottery,celery,annual,split,panther,bacon,romance,situate,barrel,job,husband,resource,fork,misery,execute,wealth,column,gas,yard,width,sister,glove,weird,wool,menu,frozen,actress,pair,chef,trick,myth,blind,worry,size,fat,nurse,know,play,intact,useless,asthma,craft,journey,drift,moral,improve,wing,ignore,battle,roof,country,arrive,hamster,order,punch,love,match,firm,measure,where,affair,appear,gadget,defy,immense,prize,desert,tongue,gesture,naive,barely,original,kidney,valve,document,public,cook,scissors,bundle,olympic,tomorrow,health,tell,turtle,domain,razor,diesel,win,flame,veteran,settle,thank,left,tonight,glance,giraffe,blur,much,family,february,depth,obvious,magic,ketchup,vivid,grid,dice,poverty,tribe,math,helmet,race,december,dial,table,uncle,turn,employ,pulse,add,liquid,talk,inch,bone,build,cup,rabbit,boy,fabric,nuclear,convince,turkey,seek,novel,cluster,draw,bitter,minute,language,ankle,quick,piece,wine,sport,boost,blood,endorse,earth,session,social,illness,since,nephew,fury,concert,anxiety,lizard,cradle,doll,market,tape,plate,olive,deer,ride,because,address,sting,attract,enhance,call,hunt,blade,anger,hobby,check,image,good,prefer,code,smoke,weapon,purity,cloud,salute,soda,jeans,dumb,habit,scale,useful,nice,bench,brief,april,inject,river,open,mail,inflict,leave,vicious,ghost,beach,lunar,woman,smooth,elder,pole,keep,ready,divide,old,volume,develop,cargo,voyage,retire,busy,side,balcony,extra,describe,glad,grunt,earn,arrest,taxi,amused,pizza,gold,bread,answer,shrug,remember,father,pulp,cotton,notice,banana,luxury,light,key,wild,loud,kitchen,assume,airport,road,trade,visa,paper,rule,again,negative,siren,bachelor,frequent,hollow,bamboo,soldier,category,iron,electric,gaze,fog,this,damage,powder,sample,embrace,bus,bring,pig,topple,toss,mention,little,denial,tobacco,excess,bid,live,ceiling,achieve,render,follow,morning,violin,media,sun,bounce,hill,copper,raw,simple,rough,law,replace,search,limb,fringe,about,lounge,maze,chicken,manage,tired,monkey,angry,engine,unhappy,crane,office,antique,mistake,mix,venture,glue,pink,admit,install,glory,spot,basket,genre,license,kitten,dragon,air,slab,lyrics,hope,weather,bird,sugar,apart,dawn,apology,bulb,parent,broken,video,general,police,daughter,mule,movie,biology,snake,wheel,uniform,modify,envelope,panel,sphere,cage,grab,meat,armor,crop,invite,tornado,flag,observe,empower,boat,filter,imitate,nature,oxygen,shine,behave,reunion,quality,subject,thumb,recycle,direct,write,wash,then,tunnel,hold,wet,rich,tumble,identify,shrimp,debate,insane,adapt,item,guess,result,damp,cycle,avocado,aware,agree,spell,artefact,either,buzz,core,spin,quiz,drop,addict,explain,pyramid,raven,daring,rotate,rain,satisfy,mountain,edge,snap,skirt,grant,wrestle,pave,glass,enemy,east,frown,maid,act,amount,rely,bullet,clap,decrease,butter,reward,interest,game,plug,human,claw,twist,leopard,hybrid,calm,north,awake,mass,demand,half,lady,shaft,food,ill,magnet,alarm,stereo,once,egg,announce,badge,ring,dust,garden,globe,retreat,opinion,idea,update,slam,coffee,remain,lava,avoid,fitness,tortoise,number,program,canvas,crystal,dance,work,energy,tenant,height,stamp,believe,pencil,spider,impose,boil,diet,piano,symptom,rapid,step,science,stand,timber,assault,broom,dash,coach,cause,drama,force,uncover,lonely,gentle,final,claim,picnic,hand,peace,oven,trouble,crazy,comfort,raccoon,primary,cherry,oblige,miss,glow,inhale,rebuild,radar,range,diary,hub,strong,sustain,wire,tool,mesh,vessel,insect,today,unknown,decorate,float,vintage,issue,exhaust,object,swear,club,strike,silver,garage,tail,tone,next,ostrich,smart,swamp,kit,honey,rebel,ugly,garlic,debris,pool,rescue,double,betray,fever,donkey,shoot,forget,robot,correct,provide,sight,cereal,mirror,grief,change,shift,dinner,token,traffic,crater,spray,screen,excite,express,mansion,kiss,find,finger,kind,obey,leisure,certain,glare,safe,effort,bless,angle,cat,snack,tissue,select,worth,merry,confirm,flush,fade,already,delay,upset,wide,bleak,coral,crack,taste,term,truck,despair,rookie,wasp,room,ranch,isolate,milk,royal,autumn,auto,load,nest,monitor,wall,pride,urban,panic,share,funny,cool,face,winner,method,song,super,mother,total,scene,scheme,wait,fashion,loop,dilemma,viable,suffer,fun,remove,skate,jazz,caution,shiver,critic,tourist,symbol,subway,happy,protect,liar,zone,depend,bronze,transfer,risk,clinic,fish,peasant,matter,riot,level,buddy,wrong,degree,pilot,quit,eagle,emerge,visual,cave,forward,syrup,weekend,source,that,ordinary,stage,stadium,jacket,man,glimpse,kick,estate,alley,maple,chalk,curious,sell,champion,fetch,ethics,blame,outside,vacant,garment,trust,exhibit,muffin,burger,tray,nose,couch,candy,only,unit,person,secret,fence,square,come,napkin,phone,reopen,draft,tomato,grow,park,educate,horn,hour,cousin,tackle,buffalo,goose,dad,alter,profit,ski,chase,adjust,robust,unaware,later,case,around,require,nominee,alone,sure,abstract,grace,squirrel,rifle,marriage,phrase,vapor,exotic,ramp,shove,able,economy,feed,warfare,album,try,arctic,skull,fall,bargain,fresh,potato,virus,minor,fame,cabbage,stuff,hip,rally,soft,lazy,holiday,relief,wagon,organ,gain,security,rubber,sketch,flower,okay,wise,just,detect,indicate,inner,erase,team,inspire,flavor,front,verb,swap,sausage,danger,place,amateur,frame,ensure,strategy,enter,aisle,drive,other,else,feel,patch,virtual,awful,caught,another".components(separatedBy: ",")
            
            let mnemonicMasterKey = Data(base64Encoded: "1lGts67cYQ9I4f23qvEG20PlRRvfr3lqPTUCuRkJwAY=")?.bytes
            let mnemonicMasterKeyEncryptionIV = Data(base64Encoded: "5RnFHrh3vQeZOaA4ZKKOdg==")?.bytes
            let encryptedMnemonicMasterKey = try CryptoUtil.encryptValue(plainValue: mnemonicMasterKey!, key: derivedPassword!, iv: mnemonicMasterKeyEncryptionIV!)
            
            XCTAssertNotNil(encryptedMnemonicMasterKey.toBase64())
            XCTAssertEqual(encryptedMnemonicMasterKey.toBase64(), "HoEqAiR7L99MOrCkixWHXPZHcP06seCVVGnda0XzF0U=")
            
            let mnemonic = "close food aware intact hill spirit aerobic topple anxiety submit dilemma ripple palm skill sell frequent okay lounge anchor carry sport jump lab client"
            let mnemonicWords = mnemonic.components(separatedBy:" ")
            let mnemonicIndices = mnemonicWords.map { (word) -> UInt16 in
                if let index = wordList.index(of: word) {
                    return UInt16(index)
                }
                return UInt16(0)
            }
            
            var mnemonicBytes = Array<UInt8>()
            for byte in mnemonicIndices {
                mnemonicBytes.append(UInt8(byte >> 8 & 0x00ff))
                mnemonicBytes.append(UInt8(byte & 0x00ff))
            }
            
            let mnemonicEncryptionIV = Data(base64Encoded: "RweB351POc5jU6rgCAubMQ==")?.bytes
            let encryptedMnemonic = try CryptoUtil.encryptValue(plainValue: mnemonicBytes, key: mnemonicMasterKey!, iv: mnemonicEncryptionIV!)
            
            XCTAssertNotNil(encryptedMnemonic.toBase64())
            XCTAssertEqual(encryptedMnemonic.toBase64(), "uwF3/1+tpqE6Xx8FYTRywn29058RRsRG7bHvyWAQbewXg+9KUA2iNuQEvPTnmvIg")
            
            var mnemonicIndices2 = Array<UInt16>()
            for i in 0..<mnemonicBytes.count/2 {
                let a = UInt16(mnemonicBytes[i*2])
                let b = UInt16(mnemonicBytes[i*2+1])
                mnemonicIndices2.append((a << 8) + b)
            }

            XCTAssertEqual(mnemonicIndices, mnemonicIndices2)
            
//            let words = wordList.joined(separator: ",")
            
//            let wordListEncryptionIV = Data(base64Encoded: "upjc/EStPb6aoKaSZmZbEg==")?.bytes
//            let wordListBytes = CryptoUtil.padToBlocks(source: words).bytes
//            let encryptedWordList = try CryptoUtil.encryptValue(plainValue: wordListBytes, key: wordListMasterKey!, iv: wordListEncryptionIV!)
            
        } catch {
            print("Error: \(error)")
            XCTAssert(false)
        }
    }
    
    func test2AccountGeneration() {
        do {
            let derivedPassword = Data(base64Encoded: "vQma44K9EAuNHgJlkI1iH/UTq0IqnwYx1Ha4v4T+w28=")?.bytes
            
            let wordListMasterKey = Data(base64Encoded: "8SrX4xthmhagHsUlTH50emY9nnd+7qaAprGdKdXenx8=")?.bytes
            let wordListMasterKeyEncryptionIV = Data(base64Encoded: "13KwndA1Dp6m9r5lauoOXQ==")?.bytes
            let encryptedWordListMasterKey = try CryptoUtil.encryptValue(plainValue: wordListMasterKey!, key: derivedPassword!, iv: wordListMasterKeyEncryptionIV!)
            
            XCTAssertNotNil(encryptedWordListMasterKey.toBase64())
            XCTAssertEqual(encryptedWordListMasterKey.toBase64(), "4w44kFZMg/GBULYGg0ZzAGyAumIYS19clunnJQkoHV4=")
            
            let wordList = "afford,idea,another,tragic,dove,celery,conduct,aisle,erase,response,adjust,citizen,divert,boy,anxiety,view,owner,way,hard,tonight,twice,glue,caution,amazing,neglect,violin,spot,chat,fiscal,safe,fruit,unusual,social,hamster,galaxy,file,wife,organ,tank,hunt,team,suit,ankle,polar,auto,analyst,excess,long,effort,build,van,impulse,tissue,peasant,mule,episode,tongue,tumble,energy,evil,speak,awful,tired,battle,village,page,shift,wink,salon,annual,toddler,syrup,praise,side,century,avocado,visa,identify,private,paddle,insect,run,someone,fall,midnight,purse,apology,script,veteran,actor,ridge,diamond,human,jelly,crack,toast,radar,burst,supply,ivory,second,mesh,involve,notable,ill,brand,base,volcano,outside,smile,spoil,leader,pill,top,mixed,when,harvest,father,blade,screen,holiday,lab,just,spike,between,prefer,isolate,perfect,fury,female,become,nothing,urban,spoon,hold,broken,gather,panel,echo,address,naive,law,journey,nuclear,leopard,equip,seed,olive,cliff,vanish,canal,defy,gold,caught,truly,rookie,swarm,margin,decline,poverty,stairs,message,theme,amused,february,april,fence,title,used,sample,degree,foil,opinion,finger,flock,demand,inside,escape,ceiling,sense,armor,sweet,pulp,injury,soap,dress,bean,wall,legend,wasp,toss,actual,crumble,swallow,pass,sentence,solve,piano,giggle,brief,push,token,twin,trade,zero,sponsor,zebra,mango,exotic,middle,spread,wisdom,merry,gown,famous,pen,scare,lazy,you,sea,clog,wrong,awake,devote,rotate,scissors,draw,lens,betray,forward,system,fold,warfare,success,image,orange,happy,argue,lumber,come,steel,fantasy,beef,chest,breeze,dinner,panther,pair,weekend,merge,bamboo,above,tortoise,agree,whip,company,camp,slide,junk,method,share,crouch,thumb,worry,dry,pole,field,ask,purchase,flip,old,duty,wreck,melt,final,access,pond,subject,gap,common,chef,forest,focus,rival,crush,symptom,post,fatigue,document,skill,mechanic,feel,current,grab,dinosaur,lecture,vessel,home,recycle,hip,more,giraffe,track,inflict,alert,card,lock,cup,urge,trap,category,orient,canvas,stock,dilemma,either,program,robot,crisp,kidney,carpet,purpose,video,blur,alpha,sand,witness,like,giant,skin,medal,tag,bleak,cherry,stereo,tube,romance,vast,gossip,play,genius,size,kit,kingdom,neutral,mask,sphere,airport,truth,shallow,reward,eternal,remind,helmet,unhappy,frequent,valid,body,junior,thank,error,arrange,feed,choose,era,mobile,own,broom,faculty,swing,charge,door,desert,dutch,rough,blush,reform,love,enemy,noble,hybrid,sell,angle,provide,once,pepper,carry,float,knife,glass,dash,canoe,cream,senior,fade,unfair,viable,kitchen,frown,simple,kitten,lady,initial,consider,utility,key,torch,grant,twenty,stone,hungry,differ,sock,crash,question,jaguar,mention,minute,trophy,around,expand,submit,claw,hover,embody,nest,price,remain,clutch,sing,fashion,history,champion,antenna,work,stadium,blanket,ugly,swamp,problem,alley,govern,apart,gesture,mean,guilt,skirt,amount,useful,host,solid,recipe,comic,age,sorry,grape,sure,shoe,lion,live,tribe,relief,roast,beach,power,master,census,catalog,wheat,ready,opera,exclude,ignore,eagle,keen,elbow,square,vibrant,student,parent,act,jeans,observe,sting,example,pizza,say,business,only,half,average,grace,fatal,remember,obscure,elite,shaft,retreat,spell,depth,before,clip,number,gorilla,october,kid,close,heart,gallery,maple,advice,hand,fame,timber,busy,random,round,fever,pony,ring,profit,scrap,tennis,lounge,gift,seek,sunny,buddy,reject,neither,group,course,dance,monster,connect,orbit,grass,resemble,network,extra,index,bracket,balance,magic,ribbon,dream,maid,bundle,real,demise,walnut,hurdle,ostrich,purity,trust,list,matter,rose,rescue,endless,empty,faith,exhibit,disagree,coach,reduce,head,auction,nation,rude,fly,result,topic,pipe,bargain,crop,indicate,reflect,trouble,wheel,victory,loud,found,baby,rug,tenant,economy,mass,deny,normal,any,enforce,grain,dice,river,envelope,can,table,shrug,scorpion,trumpet,device,school,habit,clinic,glimpse,donor,bachelor,bunker,entire,cloud,acoustic,license,circle,wide,slow,occur,frost,prison,vote,flight,aspect,two,donkey,surround,beyond,buyer,inhale,snap,jungle,major,raccoon,jealous,club,vehicle,lizard,segment,immune,oblige,drip,state,improve,daring,eyebrow,craft,abandon,drastic,winner,town,pioneer,glance,there,essay,tell,wing,announce,want,onion,layer,about,shiver,pluck,sudden,enough,comfort,dog,dismiss,lend,tray,net,alter,rebuild,mammal,nut,horror,solution,blind,salad,sick,enlist,crowd,world,plug,position,board,slight,latin,enact,tattoo,online,expect,valve,light,mad,ramp,record,web,total,select,mail,smoke,liquid,soda,cricket,talk,jump,smooth,fire,uncover,easily,sausage,sound,move,carbon,then,believe,exhaust,win,that,audit,mimic,huge,dish,rice,monitor,estate,harsh,enter,unlock,slot,rapid,thrive,robust,drift,match,stumble,cover,misery,code,gain,lamp,furnace,antique,popular,next,rather,assume,meat,rocket,humble,patient,claim,weasel,calm,denial,stamp,twelve,public,sort,forum,add,swear,feature,taste,biology,absorb,vicious,mansion,cage,tooth,brass,punch,engage,absurd,west,confirm,true,motion,payment,blouse,icon,traffic,regret,almost,brush,casino,firm,whale,favorite,draft,depend,aim,space,insane,game,nurse,grit,hope,kind,ritual,barrel,eye,little,bullet,peanut,blast,silk,harbor,cross,help,avoid,deal,limit,disorder,essence,review,bike,waste,hazard,pledge,laptop,razor,inspire,pumpkin,gasp,tone,route,stove,slice,cluster,wave,void,abuse,crazy,this,machine,frog,clay,museum,wash,hole,install,explain,accuse,barely,patch,report,news,knee,trend,dawn,tourist,into,sunset,shrimp,penalty,member,sad,vintage,walk,bar,tuition,deposit,juice,butter,muscle,million,local,cousin,near,replace,credit,lesson,assist,stand,lunch,panic,army,distance,canyon,acid,cabin,stomach,flag,wild,dizzy,merit,whisper,city,glow,crunch,since,better,action,myself,ten,green,inherit,parade,magnet,awkward,story,trigger,quality,rich,eight,leisure,thought,brown,cook,capable,certain,sugar,earth,hockey,hotel,nephew,street,loop,try,display,cable,clump,boring,begin,despair,coconut,cheese,flat,twist,hello,trim,stable,sadness,exact,bulb,crane,travel,cruise,steak,join,during,cargo,pyramid,elegant,decide,planet,photo,dignity,section,child,vacuum,panda,dust,boss,creek,hurry,cinnamon,deliver,shell,cheap,boost,color,open,odor,release,strategy,sheriff,scrub,thing,warrior,autumn,refuse,roof,weird,animal,shock,benefit,voyage,future,symbol,vital,security,coffee,orchard,birth,curtain,link,liberty,aware,judge,level,cupboard,leg,combine,excuse,surge,small,turkey,destroy,unveil,soup,unit,relax,oppose,unable,clean,turn,excite,wise,stool,shed,dynamic,quantum,menu,main,soldier,debate,shine,good,letter,olympic,term,inform,phrase,slender,curve,various,palace,wear,collect,supreme,raw,sister,toilet,useless,prevent,cycle,wet,blue,saddle,behind,decorate,extend,name,scene,acquire,shadow,cereal,bottom,today,puppy,step,pig,wood,arena,target,spy,alien,fiction,guard,spring,increase,fresh,matrix,knock,evidence,word,shoot,transfer,proud,dial,math,deer,diary,ghost,execute,buffalo,belt,nice,globe,need,away,fuel,design,wealth,dragon,other,all,fluid,moment,fork,glove,exist,defense,attract,flame,type,rubber,rail,behave,vendor,warm,staff,captain,train,off,burden,prosper,toward,wrist,attack,pear,clerk,park,indoor,bring,august,joy,fault,dose,budget,silly,cry,boil,label,party,cool,style,rule,oyster,napkin,bench,range,nominee,model,water,enroll,copper,ball,uphold,first,pet,among,night,worth,lobster,possible,valley,minor,ability,skate,change,electric,easy,glide,venture,ketchup,drink,make,glory,describe,wedding,disease,festival,pretty,evolve,pact,call,black,rally,visit,achieve,march,such,bless,answer,interest,pause,sibling,appear,angry,burger,mercy,bicycle,blame,chase,short,flash,doll,wrap,across,bomb,doctor,rack,garment,still,length,flee,metal,box,minimum,air,pistol,arctic,physical,include,poet,pink,dentist,language,snow,tornado,squirrel,vacant,cave,limb,mutual,spider,jazz,kangaroo,cloth,coin,diet,labor,output,topple,seat,frozen,please,spray,speed,fortune,kite,fossil,runway,define,umbrella,okay,cash,slush,know,brave,drum,eager,prepare,chief,face,welcome,multiply,tape,skull,outer,bright,young,science,damage,unknown,farm,prize,drill,narrow,mother,special,depart,gravity,ancient,teach,picture,corn,few,dune,print,situate,reopen,predict,country,shop,noodle,vapor,afraid,accident,wage,poem,lava,seven,hospital,voice,coil,erode,laugh,zone,check,novel,fun,year,elder,pottery,adult,squeeze,similar,below,receive,tiger,paper,lake,ozone,trial,fiber,process,island,require,pupil,tomato,imitate,option,bone,marble,humor,pattern,scan,later,learn,time,author,negative,foot,anger,film,very,choice,salt,boat,session,spice,zoo,guess,gate,balcony,three,stem,unique,foster,alcohol,width,venue,ripple,grief,abstract,dad,allow,jacket,cushion,present,wine,hub,faint,guide,raise,cost,bacon,horse,heavy,room,lift,police,six,find,jewel,tent,place,empower,cabbage,drive,suffer,leaf,gas,sustain,mind,lottery,input,else,marriage,summer,embark,yard,unaware,upon,cute,pencil,fragile,where,gym,until,spawn,chimney,foam,bird,funny,critic,east,elevator,surface,raven,actress,shoulder,congress,object,fringe,basic,gentle,ranch,because,lucky,solar,addict,erupt,divide,express,memory,ordinary,together,oxygen,deputy,notice,obey,car,case,tower,wagon,hill,bounce,chalk,brain,badge,ethics,bus,culture,window,intact,fee,neck,one,rent,protect,season,oil,morning,broccoli,crystal,winter,yellow,music,gaze,absent,glare,arch,fat,verify,soon,kiwi,beauty,vague,inquiry,follow,inch,hundred,tackle,talent,scheme,armed,client,portion,slam,athlete,couple,elephant,decade,delay,blossom,resource,banana,start,impact,approve,danger,inmate,slogan,myth,omit,priority,hat,sport,aunt,girl,income,library,manage,grocery,crime,task,stage,pride,person,couch,expose,sniff,affair,copy,tool,expire,scout,uncle,account,forget,now,fit,cruel,decrease,rifle,daughter,garage,road,crucial,fan,donate,federal,tide,attitude,pigeon,modify,engine,sign,frame,tilt,sun,hammer,kiss,fitness,exile,write,reason,garlic,they,fog,siege,jar,ocean,chapter,figure,gadget,render,soft,agent,mystery,wrestle,glad,gun,illness,much,friend,amateur,axis,mosquito,never,siren,immense,job,right,again,attend,enjoy,universe,cause,palm,scale,cactus,emerge,brisk,man,innocent,vocal,derive,settle,wolf,assault,swap,reunion,inner,curious,ahead,dumb,rare,salmon,crew,enrich,mistake,crawl,convince,basket,return,sword,race,cannon,detect,hire,load,gauge,shove,gloom,invest,garden,hour,measure,wonder,banner,verb,typical,pelican,anchor,bridge,border,guitar,quote,rhythm,under,melody,market,split,proof,column,produce,goat,riot,cattle,exchange,bind,pull,debris,order,motor,spatial,borrow,obtain,velvet,filter,flush,artwork,fabric,mom,nose,emotion,tree,duck,issue,asthma,unfold,edge,element,coyote,ride,book,crater,liar,obvious,dirt,legal,upper,fetch,cotton,discover,floor,area,update,thunder,correct,core,royal,alone,tunnel,vault,pitch,arrest,north,industry,swift,what,ensure,develop,usage,recall,treat,asset,mouse,exit,ginger,survey,pilot,stay,ladder,honey,flavor,youth,soccer,inject,south,save,adapt,clarify,satisfy,pudding,laundry,coast,desk,fox,equal,marine,advance,renew,family,logic,search,buzz,bag,material,patrol,practice,weather,cement,lawsuit,bonus,switch,end,wire,loan,chunk,primary,vivid,clever,grow,hood,churn,tail,give,satoshi,entry,bubble,luxury,goddess,tip,source,trick,flower,sight,cart,album,uniform,seminar,media,control,enable,oval,hero,rebel,spare,spin,promote,double,phone,property,civil,rate,cake,offer,repair,virus,erosion,meadow,chronic,struggle,early,gospel,great,reveal,nature,smart,evoke,plastic,use,hint,movie,surprise,point,undo,quiz,item,catch,wool,hedgehog,mixture,slab,taxi,ecology,repeat,slim,front,monkey,able,candy,clap,awesome,tomorrow,maximum,direct,will,plate,text,garbage,ice,illegal,salute,same,invite,quick,oven,miracle,fix,force,artefact,soul,life,bulk,climb,office,outdoor,genuine,volume,arm,day,embrace,bid,large,domain,lemon,fine,arrive,hurt,luggage,camera,already,pulse,height,theory,admit,pool,note,exercise,strong,woman,wish,secret,usual,hawk,also,clock,best,diesel,clown,grunt,resist,tobacco,cram,sleep,scatter,joke,stick,risk,ski,over,click,chicken,fancy,toy,dwarf,enhance,false,lonely,suspect,drama,always,cancel,bronze,infant,lunar,art,food,super,hen,people,sketch,manual,iron,nasty,trip,weapon,remove,throw,retire,plunge,silent,december,tuna,damp,tiny,hobby,must,quit,path,version,oak,wait,upgrade,nerve,piece,snack,dolphin,endorse,regular,castle,moon,often,cigar,stuff,bitter,cube,cat,quarter,custom,suggest,educate,upset,service,blood,setup,region,atom,strike,horn,general,put,toe,rib,rain,loyal,lawn,chaos,sail,spirit,detail,husband,rigid,hollow,left,aerobic,edit,turtle,goose,visual,rural,idle,chair,brick,hair,parrot,arrow,high,silver,radio,finish,puzzle,fish,egg,kick,peace,genre,employ,mirror,cradle,virtual,song,project,milk,truck,muffin,alarm,pave,shield,miss,earn,rely,permit,subway,spend,have,mushroom,snake,orphan,brother,hidden,trash,casual,artist,noise,swim,mandate,keep,powder,drop,mountain,rabbit,ship,lyrics,capital,bread,digital,apple,coral,leave,sauce,moral,picnic,diagram,maze,impose,health,test,chuckle,original,month,mix,concert,series,potato,shuffle,shy,divorce,grid,ticket".components(separatedBy: ",")
            
            let mnemonicMasterKey = Data(base64Encoded: "NOnqqYsGpsA04SzmA9XtNF6BSxEyMJOaZIkH68KacyQ=")?.bytes
            let mnemonicMasterKeyEncryptionIV = Data(base64Encoded: "5RnFHrh3vQeZOaA4ZKKOdg==")?.bytes
            let encryptedMnemonicMasterKey = try CryptoUtil.encryptValue(plainValue: mnemonicMasterKey!, key: derivedPassword!, iv: mnemonicMasterKeyEncryptionIV!)
            
            XCTAssertNotNil(encryptedMnemonicMasterKey.toBase64())
            XCTAssertEqual(encryptedMnemonicMasterKey.toBase64(), "7rHASaK8+13w/jma1ghOFwCL2Nrsljonl9holFYFtv8=")
            
            let mnemonic = "tone dry impulse today weapon raw flame drill organ someone denial wrap lucky clock fabric feature turn vague kid twist october master then stand"
            let mnemonicWords = mnemonic.components(separatedBy:" ")
            let mnemonicIndices = mnemonicWords.map { (word) -> UInt16 in
                if let index = wordList.index(of: word) {
                    return UInt16(index)
                }
                return UInt16(0)
            }
            
            var mnemonicBytes = Array<UInt8>()
            for byte in mnemonicIndices {
                mnemonicBytes.append(UInt8(byte >> 8 & 0x00ff))
                mnemonicBytes.append(UInt8(byte & 0x00ff))
            }
            
            let mnemonicEncryptionIV = Data(base64Encoded: "8IB/YJlPZZkkmEg7oD1aXw==")?.bytes
            let encryptedMnemonic = try CryptoUtil.encryptValue(plainValue: mnemonicBytes, key: mnemonicMasterKey!, iv: mnemonicEncryptionIV!)
            
            XCTAssertNotNil(encryptedMnemonic.toBase64())
            XCTAssertEqual(encryptedMnemonic.toBase64(), "/GTUHHacGBicNZdfr96HSFzBUp2/ZOA20EsRWBIfI9l8xXTJaPORkBh5uJMeRuXJ")
            
            var mnemonicIndices2 = Array<UInt16>()
            for i in 0..<mnemonicBytes.count/2 {
                let a = UInt16(mnemonicBytes[i*2])
                let b = UInt16(mnemonicBytes[i*2+1])
                mnemonicIndices2.append((a << 8) + b)
            }
            
            XCTAssertEqual(mnemonicIndices, mnemonicIndices2)
            
            let words = wordList.joined(separator: ",")
            
            let wordListEncryptionIV = Data(base64Encoded: "upjc/EStPb6aoKaSZmZbEg==")?.bytes
            let wordListBytes = CryptoUtil.padToBlocks(source: words).bytes
            let encryptedWordList = try CryptoUtil.encryptValue(plainValue: wordListBytes, key: wordListMasterKey!, iv: wordListEncryptionIV!)
            
            XCTAssertNotNil(encryptedWordList.toBase64())
//            XCTAssertEqual(encryptedWordList.toBase64(), "")
        } catch {
            print("Error: \(error)")
            XCTAssert(false)
        }
    }
    
    func test3AccountGeneration() {
        do {
            let derivedPassword = Data(base64Encoded: "JsyPZb39X9/WnbHDLKNVn1y4XwaxPth6RIV6K7ldPGE=")?.bytes
            
            let wordListMasterKey = Data(base64Encoded: "4XT/HKix1lejbZOOtKX4gA9PsaKXKi4+q/y6JB3L35g=")?.bytes
            let wordListMasterKeyEncryptionIV = Data(base64Encoded: "sa+wCK7PAhz4tb0whbPJaA==")?.bytes
            let encryptedWordListMasterKey = try CryptoUtil.encryptValue(plainValue: wordListMasterKey!, key: derivedPassword!, iv: wordListMasterKeyEncryptionIV!)
            
            XCTAssertNotNil(encryptedWordListMasterKey.toBase64())
            XCTAssertEqual(encryptedWordListMasterKey.toBase64(), "u/vboV726Ae6n1KB895ng5hAs30317tcQTNePwpMsbE=")
            
            let wordList = "learn,lizard,physical,attract,process,bounce,chair,bullet,limit,crash,elite,view,else,nest,gap,actual,idle,try,subway,slice,purse,opinion,sphere,length,squirrel,label,write,risk,common,enough,silent,bar,front,reform,almost,inmate,engage,erase,neck,glove,tail,apart,payment,pigeon,color,power,north,mouse,stool,accuse,simple,crucial,bitter,income,civil,rotate,uphold,joke,retreat,happy,journey,motor,betray,lonely,ride,weapon,loan,satisfy,mystery,proud,cook,license,trouble,bottom,argue,coast,leader,chimney,vehicle,develop,victory,stay,high,brand,hamster,fiber,track,provide,clip,rain,urban,three,brick,voice,pulp,ahead,assault,hammer,special,food,friend,crack,item,can,convince,submit,ginger,loyal,barrel,clerk,have,message,next,salmon,awake,frown,assist,unlock,cycle,palace,stove,plastic,dilemma,stomach,chronic,auto,announce,dust,once,woman,salon,traffic,thing,reduce,copy,believe,gentle,fragile,boss,final,donate,desert,space,letter,fun,leave,farm,struggle,rule,burger,vicious,gym,circle,dirt,achieve,fall,cable,humor,capable,flush,direct,pig,pretty,fiction,tent,obvious,congress,zoo,lock,lazy,attend,myth,nature,two,soccer,wood,arena,olympic,outer,post,win,dizzy,enhance,february,pattern,grape,demand,because,scissors,good,maid,legal,blur,ethics,dragon,alter,artist,thumb,roast,swap,input,spread,spoil,add,access,inquiry,expect,city,practice,october,enlist,kitten,camp,feature,manage,crawl,average,obey,panther,cash,crunch,hedgehog,lunar,thank,month,alcohol,valve,satoshi,urge,mammal,kick,meadow,diamond,man,toddler,actor,crush,artwork,behave,task,fuel,insane,trade,skate,garden,hard,elegant,move,turtle,useless,response,disagree,vast,arctic,keen,ship,suspect,box,rather,program,dish,bless,end,conduct,cherry,company,between,spy,total,portion,tumble,tiger,aerobic,scout,file,sponsor,member,abandon,obscure,mention,flat,subject,gallery,error,swing,avoid,undo,fat,dial,sister,blouse,fantasy,border,shrug,denial,wrist,bright,pottery,famous,imitate,plate,frozen,local,swim,turkey,mechanic,water,sea,balance,enable,shiver,evil,rare,chief,enroll,supreme,maximum,moral,slam,stuff,act,print,muscle,hood,answer,runway,emerge,pen,action,able,net,choice,asthma,sample,lucky,apology,pyramid,issue,endorse,annual,tuition,sand,song,scheme,chalk,hope,dream,cheap,right,trigger,erode,window,system,sugar,news,chase,meat,hunt,badge,camera,when,any,ability,wash,pilot,trumpet,anxiety,sun,rifle,enjoy,cattle,romance,forum,cause,decorate,reject,sight,effort,arrow,inherit,supply,glory,naive,cruise,note,head,tunnel,ancient,area,page,device,suit,medal,crumble,group,correct,private,visit,skill,stone,soul,kidney,twin,movie,topic,train,spice,height,snap,ritual,invest,dad,fury,eternal,finish,minor,symptom,soda,clog,lava,index,combine,check,whisper,bubble,install,dove,test,certain,decline,fancy,lesson,blast,million,misery,leg,mesh,security,notice,canvas,tower,state,wise,pact,merit,twenty,maze,inner,breeze,employ,sleep,jeans,frequent,corn,truth,goddess,island,flag,couch,spend,prefer,fine,roof,hub,grace,giant,stock,hip,wait,predict,faith,soon,hair,absurd,recall,eight,rice,amount,void,buffalo,army,across,floor,dwarf,travel,alien,dune,debris,inhale,embark,glimpse,multiply,hurt,shoot,same,prison,faint,race,fix,small,calm,category,rural,noodle,cart,silk,dawn,sunny,air,filter,negative,strategy,main,feed,nurse,dynamic,story,verify,dismiss,ladder,kite,pioneer,describe,rubber,pink,midnight,rookie,return,pole,sound,erupt,snow,sick,sunset,very,unable,what,situate,recipe,planet,worry,night,rescue,winner,shaft,genre,purchase,hint,size,ill,ocean,shy,sauce,mother,transfer,fiscal,pistol,horn,original,weather,inch,define,hold,segment,benefit,bind,afraid,forward,layer,mercy,green,bracket,question,catch,feel,swift,blame,modify,above,puzzle,involve,escape,dinner,faculty,fatal,bacon,tribe,rely,door,few,acoustic,need,genuine,surge,spare,black,latin,object,poem,renew,lawn,pupil,theme,fitness,skin,reunion,start,one,park,element,seminar,half,universe,office,april,uncover,hawk,violin,review,help,wage,gloom,oyster,crowd,knee,banana,survey,give,pill,polar,possible,advice,tip,evidence,expire,ramp,barely,honey,bring,horror,degree,this,gown,kingdom,adjust,increase,dignity,fame,cinnamon,turn,edit,chaos,outdoor,rich,reflect,author,analyst,casino,sell,acquire,snake,weasel,panel,trophy,viable,wagon,utility,maple,solution,bag,narrow,hungry,hotel,film,taste,spring,luxury,web,ostrich,curve,mail,puppy,foot,road,sausage,awkward,cover,wealth,entry,mosquito,diary,unique,tooth,close,hazard,husband,blossom,lens,say,share,amateur,junk,elbow,slush,doctor,oppose,please,assume,throw,siren,crop,daughter,furnace,lawsuit,inform,hidden,client,wolf,phrase,follow,quick,boy,dutch,skirt,child,robot,approve,earth,creek,shadow,marriage,wine,excess,vessel,shallow,rebuild,winter,clap,prevent,stick,pencil,useful,fluid,now,raise,stage,want,angle,remind,family,era,guide,slight,drastic,day,mule,spell,hole,galaxy,version,dress,silly,more,promote,then,mix,census,demise,cute,fan,fashion,favorite,canoe,cram,exotic,grant,custom,bulb,album,hurdle,job,gorilla,fresh,hand,old,verb,ensure,blanket,focus,code,mandate,car,shell,despair,shine,seek,defy,rate,avocado,jungle,large,drift,junior,off,home,liberty,truck,blush,resource,busy,face,toast,dolphin,digital,cradle,coffee,visa,sniff,permit,snack,audit,absent,cliff,tired,search,wide,exhaust,ugly,alley,hat,wild,wheat,deny,begin,lady,crazy,remain,middle,fruit,tomato,wedding,flame,poverty,desk,exchange,upon,blood,carbon,unveil,forest,kitchen,update,olive,quality,educate,pool,fossil,cross,poet,year,deliver,word,wheel,life,discover,push,curtain,crew,trim,secret,only,pelican,sort,relax,whip,lunch,trick,casual,gasp,art,stadium,kiss,pear,unfold,force,treat,asset,cannon,quantum,apple,exercise,ripple,bike,lift,glance,anger,clutch,render,long,balcony,illegal,wire,video,often,scan,merry,royal,raccoon,rack,gesture,nephew,reward,sentence,aware,rug,captain,brother,enter,lounge,donor,shoe,bunker,lumber,purpose,cup,fatigue,enforce,evolve,scrap,coyote,law,mass,usage,milk,sorry,chuckle,occur,student,atom,near,script,detect,idea,inspire,damage,voyage,lake,antenna,vacuum,board,carpet,nuclear,cereal,toe,again,picture,tube,fault,human,glare,devote,network,acid,you,marine,base,wife,photo,room,depart,harvest,ball,warrior,vocal,mutual,pond,much,sword,patrol,biology,whale,future,pull,spot,will,suggest,novel,gossip,that,inject,crystal,adult,relief,endless,ask,alert,solar,grow,ecology,couple,wrong,mixed,quiz,limb,chapter,gauge,deal,there,piano,wreck,party,hover,drill,culture,aisle,spatial,drama,tackle,vendor,punch,hour,toss,crouch,swarm,grab,cube,tank,second,glass,nothing,expand,staff,skull,ranch,peasant,volume,shock,guitar,mask,armed,cat,rebel,quarter,armor,kit,glad,leisure,health,regular,spray,priority,pause,owner,boat,someone,scare,giraffe,bench,illness,ketchup,around,hire,parent,melt,fence,where,glue,intact,lyrics,stand,load,bachelor,caution,cabin,grocery,memory,churn,know,public,miracle,glow,repair,clown,vote,peace,advance,style,body,always,call,flee,team,december,father,super,wink,speed,police,pepper,warm,grunt,van,gospel,comfort,marble,fish,hundred,unaware,monkey,rocket,spider,harsh,domain,replace,recycle,equip,craft,carry,come,mom,erosion,divert,trip,raven,plug,other,agent,tenant,blue,worth,liquid,game,pet,habit,short,duty,library,airport,bird,alarm,buddy,caught,alone,jump,vibrant,wrestle,leaf,pave,topple,ozone,click,pair,mad,hobby,claw,afford,matrix,actress,seed,unit,climb,powder,zero,light,absorb,deer,tide,budget,shove,soap,deposit,ridge,proof,below,cloud,cupboard,resist,broom,such,price,exclude,virtual,method,slab,impulse,weekend,trust,hybrid,mansion,under,draw,upper,bridge,aspect,wool,baby,unknown,better,just,finger,usual,strike,magnet,joy,jacket,danger,alpha,talent,cabbage,brass,sport,repeat,swallow,laugh,current,pledge,identify,goat,august,squeeze,opera,fade,type,sting,typical,vivid,kiwi,upset,list,young,lemon,giggle,frame,east,cheese,minimum,tornado,laundry,shift,orbit,panda,sad,minute,protect,hurry,detail,valid,beyond,stem,chunk,tongue,soft,select,grain,pizza,goose,rail,figure,merge,pride,thrive,lion,bomb,history,syrup,vital,reopen,belt,edge,first,similar,various,language,draft,sign,gun,burden,example,radio,live,put,radar,fold,awful,must,torch,cloth,harbor,time,rhythm,street,diet,gaze,brief,wasp,fire,bronze,vintage,sustain,lamp,wear,mountain,buyer,crane,walk,clump,source,luggage,humble,impose,patient,case,image,use,dose,outside,garment,swear,bone,piece,rib,unusual,slim,over,patch,spirit,coin,embody,echo,globe,borrow,bean,smile,flower,inflict,toilet,country,tortoise,dumb,own,tell,charge,attack,arrive,solve,cushion,butter,lab,myself,output,neutral,loud,oak,tattoo,card,logic,decide,measure,slot,guard,govern,virus,morning,cotton,isolate,major,obtain,before,mean,grid,cargo,grief,world,west,ordinary,nerve,retire,coach,gadget,garlic,capital,strong,castle,report,ribbon,include,token,burst,addict,nasty,jaguar,immense,clean,dry,infant,cousin,tone,bicycle,genius,duck,wrap,ice,material,plunge,garage,grit,fork,leopard,eagle,prize,flock,damp,aunt,make,abstract,tray,canyon,sense,tissue,donkey,away,gain,taxi,crater,problem,service,noble,extend,host,master,theory,melody,magic,save,cement,fortune,property,laptop,smart,double,potato,since,change,brisk,curious,coil,drum,interest,okay,extra,banner,twelve,innocent,online,used,claim,perfect,menu,heavy,frost,muffin,picnic,left,boring,best,cake,path,switch,clever,basic,top,energy,toy,business,palm,improve,flash,point,horse,exit,drink,march,catalog,organ,all,moment,vague,concert,funny,daring,today,valley,shrimp,steak,design,observe,flavor,slow,tourist,labor,yard,female,neither,session,like,find,collect,indicate,nut,fringe,liar,animal,record,rose,people,express,defense,boil,deputy,trend,name,angry,mango,remember,praise,bamboo,safe,school,person,sketch,quote,also,surround,width,pumpkin,noise,early,essay,orange,math,bread,soldier,display,sibling,parrot,normal,ski,number,salt,summer,beach,crisp,rude,axis,clay,wing,true,flip,together,slender,truly,scene,season,level,regret,easy,peanut,yellow,destroy,execute,cream,jar,tuna,produce,distance,miss,egg,among,equal,broccoli,penalty,field,monitor,age,core,wave,sing,kind,exact,anchor,reveal,wall,upgrade,rabbit,shoulder,fetch,antique,another,symbol,guess,salute,adapt,mind,salad,range,settle,drip,region,title,cricket,elephant,neglect,work,later,brown,immune,column,control,garbage,primary,grass,during,connect,refuse,match,divide,spin,fog,confirm,vanish,behind,aim,metal,timber,bulk,document,waste,random,orphan,disease,surface,vacant,release,frog,orient,oven,route,teach,mushroom,shield,youth,rent,federal,wisdom,media,pony,silver,jealous,decade,divorce,suffer,legend,forget,credit,gift,account,bargain,brave,never,scorpion,square,flight,dash,sweet,derive,slogan,initial,rough,velvet,tomorrow,oblige,knock,depth,club,hello,fit,appear,pass,chicken,paddle,helmet,stereo,shop,scatter,cigar,heart,blind,split,hill,uniform,foil,mobile,ankle,solid,option,link,onion,brush,still,cage,parade,saddle,stamp,easily,bundle,diesel,razor,trap,foam,wet,float,uncle,trial,clock,bonus,nose,series,seven,festival,tape,emotion,paper,cancel,become,venue,excite,tilt,arm,scale,ticket,found,rigid,lobster,tag,table,autumn,attitude,omit,hockey,slide,jelly,village,riot,amazing,side,phone,toward,bleak,umbrella,manual,episode,moon,rapid,gold,judge,arrange,arrest,six,iron,explain,broken,mixture,little,lottery,knife,pluck,offer,delay,basket,industry,critic,blade,order,comic,setup,machine,accident,siege,empty,great,science,market,warfare,resemble,empower,chat,town,orchard,oxygen,popular,expose,cave,exhibit,course,fabric,dentist,panic,address,prosper,athlete,glide,build,stable,raw,oil,vault,walnut,general,tragic,false,hollow,kid,inside,about,veteran,section,tobacco,engine,crime,receive,pitch,cluster,talk,clinic,senior,firm,ghost,weird,clarify,tonight,oval,kangaroo,text,ivory,earn,differ,steel,agree,mimic,affair,jewel,profit,surprise,artefact,candy,boost,juice,embrace,visual,girl,consider,place,term,key,monster,tennis,napkin,into,nice,jazz,auction,hero,already,estate,debate,elevator,river,fee,gate,twice,lecture,buzz,thought,hen,prepare,icon,dance,matter,round,quit,chest,robust,smoke,essence,entire,electric,open,copper,economy,witness,love,evoke,injury,eyebrow,diagram,invite,canal,ignore,birth,beauty,motion,unhappy,position,play,excuse,exist,scrub,stumble,disorder,insect,twist,arch,tree,foster,keep,spawn,enact,chef,museum,cool,sheriff,dice,ready,gather,zone,present,remove,they,elder,guilt,champion,screen,envelope,coconut,speak,thunder,loop,drive,celery,soup,coral,wish,citizen,awesome,wonder,social,volcano,odor,fever,zebra,south,doll,cost,huge,holiday,stairs,rally,unfair,sail,ring,smooth,bid,beef,pulse,music,project,century,spoon,fly,require,admit,depend,shuffle,dinosaur,hospital,brain,margin,either,mirror,cruel,step,ten,rival,allow,sock,shed,way,sure,indoor,result,cactus,notable,tiny,cry,enrich,book,mistake,venture,exile,choose,vapor,eye,welcome,eager,join,reason,bus,dog,nominee,success,until,run,spike,target,tool,gravity,lend,sudden,battle,drop,decrease,impact,swamp,sadness,seat,pipe,purity,abuse,model,nation,amused,gas,trash,enemy,real,pudding,fox,ceiling".components(separatedBy: ",")
            
            let mnemonicMasterKey = Data(base64Encoded: "m8q5UnUxVSlOvxGHtEwHNdpCyG6cSycnKWzgwLPCWV8=")?.bytes
            let mnemonicMasterKeyEncryptionIV = Data(base64Encoded: "5RnFHrh3vQeZOaA4ZKKOdg==")?.bytes
            let encryptedMnemonicMasterKey = try CryptoUtil.encryptValue(plainValue: mnemonicMasterKey!, key: derivedPassword!, iv: mnemonicMasterKeyEncryptionIV!)
            
            XCTAssertNotNil(encryptedMnemonicMasterKey.toBase64())
            XCTAssertEqual(encryptedMnemonicMasterKey.toBase64(), "Uezu0xIlmMA7T3kPdeTSoNwWTviXx9rBPW6qAwyAhVk=")
            
            let mnemonic = "struggle wire middle banana room firm wire tower relief rice parrot turkey because couple wire soap sketch comic still throw junk sphere auction illness"
            let mnemonicWords = mnemonic.components(separatedBy:" ")
            let mnemonicIndices = mnemonicWords.map { (word) -> UInt16 in
                if let index = wordList.index(of: word) {
                    return UInt16(index)
                }
                return UInt16(0)
            }
            
            var mnemonicBytes = Array<UInt8>()
            for byte in mnemonicIndices {
                mnemonicBytes.append(UInt8(byte >> 8 & 0x00ff))
                mnemonicBytes.append(UInt8(byte & 0x00ff))
            }
            
            let mnemonicEncryptionIV = Data(base64Encoded: "3uIWIV48Ihs3UUh5ZjCuMQ==")?.bytes
            let encryptedMnemonic = try CryptoUtil.encryptValue(plainValue: mnemonicBytes, key: mnemonicMasterKey!, iv: mnemonicEncryptionIV!)
            
            XCTAssertNotNil(encryptedMnemonic.toBase64())
            XCTAssertEqual(encryptedMnemonic.toBase64(), "OM0BRAeAotIH8XPBN+Y+pbkjDevCn8oBsyEDTvOMb2wuZh0rkDaUJJkMBKnTYNL4")
            
            var mnemonicIndices2 = Array<UInt16>()
            for i in 0..<mnemonicBytes.count/2 {
                let a = UInt16(mnemonicBytes[i*2])
                let b = UInt16(mnemonicBytes[i*2+1])
                mnemonicIndices2.append((a << 8) + b)
            }
            
            XCTAssertEqual(mnemonicIndices, mnemonicIndices2)
            
            let words = wordList.joined(separator: ",")
            
            let wordListEncryptionIV = Data(base64Encoded: "jQf2Bs4Tcok82pjA345buQ==")?.bytes
            let wordListBytes = CryptoUtil.padToBlocks(source: words).bytes
            let encryptedWordList = try CryptoUtil.encryptValue(plainValue: wordListBytes, key: wordListMasterKey!, iv: wordListEncryptionIV!)
            
            XCTAssertNotNil(encryptedWordList.toBase64())
            //            XCTAssertEqual(encryptedWordList.toBase64(), "")
        } catch {
            print("Error: \(error)")
            XCTAssert(false)
        }
    }

}
